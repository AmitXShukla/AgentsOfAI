{"kind":"Article","sha256":"f543b0f3263e7521994afc293573d0db3c78e34de8721b895d10d987612525b5","slug":"tools","location":"/content/tools.md","dependencies":[],"frontmatter":{"title":"Tool Functions","content_includes_title":false,"github":"https://github.com/AmitXShukla/AgentsOfAI","numbering":{"title":{"offset":1}},"edit_url":"https://github.com/AmitXShukla/AgentsOfAI/blob/main/content/tools.md","exports":[{"format":"md","filename":"tools.md","url":"/build/tools-65ef5e5a63d83028060bfba23a48ba6b.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"LLMs are really very powerful, let’s run a simple example and ask a question.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aOlB2e415j"}],"key":"D5xKn06szY"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"How is the weather in Los Angeles, CA today?","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"XuMr1qDqX8"}],"key":"m1FvaW7fsB"}],"key":"L2ZRTlBf00"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"import ollama\n\nresponse = ollama.chat(\n        model='llama3.2',\n        messages=[{'role': 'user', 'content': \n            'How is the weather in Los Angeles, CA today?'}]\n    )\n\nprint(f\"Content: {response[\"message\"][\"content\"]}\")","key":"WtqeVgagI9"},{"type":"output","id":"Onnw_9IAswKu6UU-JYHh4","data":[],"key":"uFkNrG5tFR"}],"data":{},"key":"CxWit7pgyv"},{"type":"block","children":[{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"result","position":{"start":{"line":20,"column":1},"end":{"line":20,"column":1}},"key":"fE5G4JgkRh"}],"key":"bOulZBUNBN"},{"type":"paragraph","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Content: I’m a large language model, I don’t have real-time access to current weather conditions. However, I can suggest some ways for you to find out the current weather in Los Angeles, CA:","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"yM9eXLYcIi"}],"key":"AvZD0bMpR4"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Check online weather websites: You can check websites like AccuWeather, ","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"UQVHlMBm2A"},{"type":"link","url":"http://Weather.com","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"text","value":"Weather.com","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"HEkGair3R9"}],"urlSource":"http://Weather.com","key":"K2CUz83ZXx"},{"type":"text","value":", or the National Weather Service (NWS) for up-to-date weather forecasts and conditions.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"mxC9lCRAGe"}],"key":"JkrQq8m2R6"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"text","value":"Use a mobile app: You can download a weather app on your smartphone, such as Dark Sky or Weather Underground, to get current weather conditions and forecasts.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"V0Uiv9weZG"}],"key":"fdCNQQlIDv"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Tune into local news: Watch local news channels or listen to radio stations to get the latest weather updates.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ut5e1i3GmL"}],"key":"F2g6A7eGgr"}],"key":"EluYHZhXFA"},{"type":"paragraph","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Please note that Los Angeles is a large city with varied weather conditions depending on the location and time of day. The city’s climate can range from sunny and mild in some areas to cooler and cloudier in others.","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"dQvLo6P8aq"}],"key":"fY09QNzCJ3"},{"type":"paragraph","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"text","value":"If you provide me with a specific date or time, I can try to give you an estimate of the typical weather conditions in Los Angeles for that particular day.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"bUtaaMUfYt"}],"key":"FmxlkJ17Ed"}],"key":"XP7fxU0E4D"},{"type":"thematicBreak","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"ZeSGm6N4vc"},{"type":"paragraph","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"What you just saw that even though LLMs are really strong, but they can’t answer questions about things happening in real time or to some information they don’t have access to.","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"wDKkE897lZ"}],"key":"obi0eXxHTM"},{"type":"paragraph","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"text","value":"What if we gave them extra info to help them get live, up-to-date details? With this real-time info, they could answer those questions.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"IflIswVuEP"}],"key":"MNXQDXmwSM"},{"type":"code","lang":"python","value":"import ollama\n\nresponse = ollama.chat(\n        model='llama3.2',\n        messages=[{'role': 'user', 'content': \n            \"\"\"How is the weather in Los Angeles, CA today?\n            BTW, here is some extra information to help you.\n            I am using a tool like function,\n            this function can access and API and as per API, \n            current weather in Los Angeles is 74 degrees.\"\"\"}],\n    )\n\nprint(f\"Content: {response[\"message\"][\"content\"]}\")","position":{"start":{"line":38,"column":1},"end":{"line":52,"column":1}},"key":"ei9lMeCrYe"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"result","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"idcVqrN0TL"}],"key":"rUzJ5rh6oc"},{"type":"code","lang":"","value":"Content: Thank you for the extra information! \nSince we're simulating an API call, I'll use that data to provide an answer.\n\nAccording to our simulated API call, the current temperature in Los Angeles, CA\n is indeed 74°F (23°C). However, without knowing the specific date \n or time of year, it's difficult to determine what type of weather \n LA is experiencing today. Was it a sunny day with clear skies, \n or was there any precipitation? Without more information,\n I can only provide the temperature data.\n\nIf you'd like to simulate more weather conditions \nor add additional details, feel free to share!","position":{"start":{"line":54,"column":1},"end":{"line":65,"column":1}},"key":"c3vuBZLK9R"}],"key":"Mt4ib8QLJP"},{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"Notice, that how simple extra information using tools provided to LLMs can really overcome this issue of not able to answer real time or domain/subject specific questions.","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"wxtoFEwXtw"}],"key":"WpJUCPtDJS"},{"type":"paragraph","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"children":[{"type":"text","value":"We call these helpers “Tools.” Let’s make a simple tool function and see how it works.","position":{"start":{"line":70,"column":1},"end":{"line":70,"column":1}},"key":"xzl9JuGOuW"}],"key":"kmccT6ZLvU"},{"type":"heading","depth":2,"position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"children":[{"type":"text","value":"Write Tool Functions","position":{"start":{"line":72,"column":1},"end":{"line":72,"column":1}},"key":"YM43NMyQk7"}],"identifier":"write-tool-functions","label":"Write Tool Functions","html_id":"write-tool-functions","implicit":true,"key":"d9JdpYfYIe"},{"type":"code","lang":"python","value":"import requests\n\ndef get_current_weather(location):\n  # https://api.weather.gov/gridpoints/TOP/32,81/forecast\n  # The API endpoint\n  url = \"https://api.weather.gov/gridpoints/TOP/32,81/forecast\"\n  response = requests.get(url)\n  return f\"\"\"The current temperature in {location} is\n         {response.json()[\"properties\"][\"periods\"][0][\"temperature\"]} \n         degrees Fahrenheit.\"\"\"\n\nget_current_weather(\"Los Angeles, CA\")","position":{"start":{"line":74,"column":1},"end":{"line":87,"column":1}},"key":"i7pJ3EylKZ"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"result","position":{"start":{"line":88,"column":1},"end":{"line":88,"column":1}},"key":"uJWGWYvk1W"}],"key":"BgvaVkD5sr"},{"type":"code","lang":"","value":"The current temperature in Los Angeles, CA is 77 degrees Fahrenheit.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"MazJF6Mskw"}],"key":"tf6W0PYsOG"},{"type":"paragraph","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"children":[{"type":"text","value":"I defined a function that makes an API call to fetch the temperature of a given city. However, we need to pass a dynamic parameter to this function, which should come from a user prompt.","position":{"start":{"line":92,"column":1},"end":{"line":92,"column":1}},"key":"aFpUUpExWU"}],"key":"LAYBAd3d5w"},{"type":"paragraph","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"children":[{"type":"text","value":"To achieve this, we will create a ","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"LA7P45aAKw"},{"type":"inlineCode","value":"tools","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"wjEMARYJnw"},{"type":"text","value":" data structure supported by the LLM framework. This structure will interpret the user prompt as a dynamic parameter, which can then be passed to the weather API function.","position":{"start":{"line":94,"column":1},"end":{"line":94,"column":1}},"key":"LagGOYUkyC"}],"key":"xzVDeXOT4J"},{"type":"code","lang":"python","value":"tools = [{\n      'type': 'function',\n      'function': {\n        'name': 'get_current_weather',\n        'description': 'Get the current weather for a location',\n        'parameters': {\n          'type': 'object',\n          'properties': {\n            'location': {\n              'type': 'string',\n              'description': 'The name of the location',\n            },\n          },\n          'required': ['location'],\n        },\n      },\n    }\n  ]","position":{"start":{"line":96,"column":1},"end":{"line":115,"column":1}},"key":"MAhdBAgmFF"},{"type":"paragraph","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"children":[{"type":"text","value":"Tools are simply a list of Python functions that can access APIs or perform other tasks to provide meaningful information. Let’s pass this tool function to ","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"qdypb6DADz"},{"type":"inlineCode","value":"ollama.chat","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"s75WIPnHWG"},{"type":"text","value":".","position":{"start":{"line":117,"column":1},"end":{"line":117,"column":1}},"key":"GtWDcW8D3h"}],"key":"O599j1W7GF"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"When we say that LLM model frameworks support ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"w8FvI7lw4M"},{"type":"inlineCode","value":"tools functions","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"lCMQ9cil9x"},{"type":"text","value":"— which most advanced LLM models do, it means that when we pass ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"Gi0D4qSeHn"},{"type":"inlineCode","value":"tools=tools","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"Pr3hDi9L9B"},{"type":"text","value":", the model can use these functions to enhance its responses.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"LK3DMXKs6v"}],"key":"RnTPOAAcnj"},{"type":"code","lang":"python","value":"import ollama\n\nresponse = ollama.chat(\n        model='llama3.2',\n        messages=[{'role': 'user', 'content': \n            \"\"\"How is the weather in Los Angeles, CA today?\"\"\"}],\n\t\t# REFACTOR: provide a weather checking tool to the model\n        tools=tools # type: ignore\n    )\n\nprint(f\"Content: {response[\"message\"][\"content\"]}\")","position":{"start":{"line":121,"column":1},"end":{"line":133,"column":1}},"key":"kL5QbLdHSs"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"result","position":{"start":{"line":135,"column":1},"end":{"line":135,"column":1}},"key":"xigHBsxCnE"}],"key":"DUdvNUwhv4"},{"type":"code","lang":"","value":"content:","position":{"start":{"line":136,"column":1},"end":{"line":136,"column":1}},"key":"N1M5kFYiVE"}],"key":"HBZL1RMwor"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"what happened here, our Tool function didn’t work, actually it did work. let’s print complete response object and you will there are much more hidden information packed in and you must understand these to help you make use of tools functions most.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"D6Gj25X8Ht"}],"key":"sU7zrpETID"},{"type":"code","lang":"python","value":"print(response)","position":{"start":{"line":140,"column":1},"end":{"line":142,"column":1}},"key":"g06ebqOnyk"},{"type":"code","lang":"python","value":"{\n    \"model\": \"llama3.2\",\n    \"created_at\": \"2025-03-07T22: 37: 49.457833367Z\",\n    \"message\": {\n        \"role\": \"assistant\",\n        \"content\": \"\",\n        \"tool_calls\": [\n            {\n                \"function\": {\n                    \"name\": \"get_current_weather\",\n                    \"arguments\": {\n                        \"location\": \"Los Angeles, CA\"\n                    }\n                }\n            }\n        ]\n    },\n    \"done_reason\": \"stop\",\n    \"done\": true,\n    \"total_duration\": 17988129148,\n    \"load_duration\": 30554277,\n    \"prompt_eval_count\": 178,\n    \"prompt_eval_duration\": 9208611000,\n    \"eval_count\": 21,\n    \"eval_duration\": 8706934000\n}\n","position":{"start":{"line":144,"column":1},"end":{"line":172,"column":1}},"key":"Ai29konNJx"},{"type":"paragraph","position":{"start":{"line":174,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"Now, let’s use the output from the tools or functions to support the LLM model and provide us with a meaningful response.\nLet’s put it altogether and simply refactor code.","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"LTIJboCdxg"}],"key":"Rl9N9Qphn1"},{"type":"blockquote","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"paragraph","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"children":[{"type":"text","value":"This code creates a basic AI chatbot that can answer a question about the weather. It asks about the weather in Los Angeles, uses a tool to get the weather info, and then lets the AI respond with the answer. If the tool is used, it adds the weather data to the chat and gets a final reply from the AI.","position":{"start":{"line":177,"column":1},"end":{"line":177,"column":1}},"key":"dq6Cb8so8T"}],"key":"HYnRxLJ13R"}],"key":"WasrlQuKQg"},{"type":"code","lang":"python","value":"# Define the messages\nmessages = [{'role': 'user', 'content': 'How is the weather in Los Angeles, CA today?'}]\nprint('Prompt:', messages[0]['content'])\n\n# Define available functions\navailable_functions = {\n    'get_current_weather': get_current_weather\n}\n\n# Import required modules\nimport ollama\nfrom ollama import ChatResponse\n# !pip install munch\nfrom munch import Munch\n\n# Define the tools specification\ntools = [\n    {\n        \"type\": \"function\",\n        \"function\": {\n            \"name\": \"get_current_weather\",\n            \"description\": \"Get the current weather in a given location\",\n            \"parameters\": {\n                \"type\": \"object\",\n                \"properties\": {\n                    \"location\": {\n                        \"type\": \"string\",\n                        \"description\": \"The location, e.g. Los Angeles, CA\"\n                    }\n                },\n                \"required\": [\"location\"]\n            }\n        }\n    }\n]\n\n# Call ollama.chat with the corrected tools parameter\nresponse_dict: ChatResponse = ollama.chat(\n    'llama3.2',\n    messages=messages,\n    tools=tools,\n)\n\n# Convert the dictionary to a Munch object\nresponse = Munch.fromDict(response_dict)\n\n# Process tool calls if present\nif response.message.tool_calls:\n    # There may be multiple tool calls in the response\n    for tool in response.message.tool_calls:\n        # Ensure the function is available, then call it\n        if function_to_call := available_functions.get(tool.function.name):\n            print('Calling function:', tool.function.name)\n            print('Arguments:', tool.function.arguments)\n            output = function_to_call(**tool.function.arguments)\n            print('Function output:', output)\n        else:\n            print('Function', tool.function.name, 'not found')\n\n    # Add the function response to messages for the model to use\n    messages.append(response.message)\n    messages.append({'role': 'tool', 'content': str(output), 'name': tool.function.name})\n\n    # Get final response from model with function outputs\n    final_response = ollama.chat('llama3.2', messages=messages, tools=tools)\n    print('Final response:', final_response[\"message\"][\"content\"])\nelse:\n    print('No tool calls returned from model')","position":{"start":{"line":179,"column":1},"end":{"line":248,"column":1}},"key":"cNkT6PsmoC"},{"type":"admonition","kind":"seealso","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"result","position":{"start":{"line":250,"column":1},"end":{"line":250,"column":1}},"key":"uBBnNbIzf9"}],"key":"L8Bqpv6vg2"},{"type":"code","lang":"","value":"content:\nPrompt: How is the weather in Los Angeles, CA today?\nCalling function: get_current_weather\nArguments: Munch({'location': 'Los Angeles, CA'})\nFunction output: 77\nFinal response: According to the tool response, \nthe current temperature in Los Angeles, \nCA is 77 degrees Fahrenheit. However,\nI couldn't find any information on today's\n weather conditions in my database. \n Can you please provide more context \n or specify which source you would like me\n  to use (e.g., OpenWeatherMap, Dark Sky, etc.)?","position":{"start":{"line":251,"column":1},"end":{"line":263,"column":1}},"key":"r3AxDCRiIT"}],"key":"hTSewlcsrI"}],"key":"sKETGsFsvY"}],"key":"reJgC0UImN"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Understanding LLM","url":"/llm","group":"Use Cases"},"next":{"title":"More Tool Functions","url":"/moretools","group":"Tools"}}},"domain":"http://localhost:3007"}